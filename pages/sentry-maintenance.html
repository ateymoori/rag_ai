Sentry Maintenance — SBAB Docs  documentation SBAB Docs Ansible Controller Ansible Roles Ansible Vault Argo Workflows Authentication & Authorization Bitbucket Boost Chatbot Booli Ceph Dex Fortigate troubleshooting Generate certificate Go GitHub Copilot GitLab @Sbab User Guide GitLab Maintenance Grafana Istio Java Jenkins Jenkinsfile Jmeter Kafka Maintenance Kafka @Sbab User Guide Kafka Connect Kubectl Access Kubernetes Lab environment Local Open Web Metrics infrastructure MongoDB Netbox NVIDIA Neo4J Sonatype Nexus repository Oracle OWASP Database OWASP @Sbab User Guide Pact Principles of Security Prometheus ReactJS Redis Renovate S3 Security Guidelines for Developers Sentry Maintenance Deploy stack Manual testing Restart stack Update certificates Slack Upgrades Upgrade procedure Sentry User Guide Configuring Variables for Services Deployed to Kubernetes Software Architecture SonarQube Maintenance SonarQube User Guide Structurizr System Landscape Vagrant Zipkin Windows Pipelines SBAB Docs » Sentry Maintenance View page source Sentry Maintenance ï Deploy stack ï Deploy the deploy-sentry.yml playbook from the Ansible Controller . Manual testing ï Trigger a new event: curl -- location -- request POST 'https://lbsys-extern.sbab.se:9000/sentry/api/4/store/' \ -- header 'X-Sentry-Auth: Sentry sentry_version=7, sentry_key=61c0b653edc44038a14796dd284800b7, sentry-cli/x86_64' \ -- header 'Content-Type: application/json' \ -- data - raw ' {} ' Verify that the <unlabeled event> issue was recently updated in: https://sentry.sys.sbab.se/organizations/sentry/issues/?project=4 Restart stack ï To restart all the services in the docker-compose stack, run the following as root: cd / opt / sentry / repo / onpremise docker - compose down && docker - compose up - d Update certificates ï Go to Gitlab Generate SSL Certificate pipeline: https://gitlab.sbab.se/tools/generate-ssl-certificate/-/tree/master/files Run the pipeline with parameter Sentry. Deploy with deploy-sentry.yml playbook from the Ansible Controller . (This will also patch and update the VM): ansible - playbook - i inventories /< ENV >/ playbooks / deploy - sentry . yml Verify by going to https://sentry .<ENV>.sbab.se Slack ï To create a new Slack app according to: https://develop.sentry.dev/integrations/slack/ Existing apps: SYS: https://api.slack.com/apps/A03CCFRMDR9/general ACC: https://api.slack.com/apps/A03DE6AHDPF/general STAGE: https://api.slack.com/apps/A03DW3X7AU9/general PROD: https://api.slack.com/apps/A03D2TWGM55/general Copy an existing appâs manifest to clipboard, e.g: Sentry SYS Create a new app from: https://api.slack.com/apps Select From an app manifest Click Request to install and wait for Patrice to approve it Add TNT collaborators Copy Client ID, Client Secret and Signing Secret from the App Credentials Add App Credentials to the bottom of /opt/sentry/repo/onpremise/sentry/config.yml Restart stack Navigate to e.g. https://sentry.acc.sbab.se/settings/sentry/integrations/slack/ and add the Slack app to the workspace Upgrades ï We are running the self-hosted version of getsentry/onpremise .
A new version is released on the 15th of each month, and patch releases are done when needed in-between.
Click here to find: the latest release the upstream documentation Upgrade procedure ï In this example we will upgrade Sentry to 20.10.0 which will be our latest available tag in this case. Navigate to getsentry/onpremise and select the latest available tag Update se.sbab/sentry to use the latest available tag Update se.sbab/sentry-snuba-cleanup to use the latest available tag Update se.sbab/sentry-symbolicator-cleanup to use the latest available tag Update ANS/sentry/defaults/main.yml with the latest Docker image tags from each pipeline: sentry_image sentry_snuba_cleanup_image sentry_symbolicator_cleanup_image Update templates/.env.j2 by comparing to getsentry/onpremise/.env Navigate to the latest release and compare the latest changes, e.g compare/20.9.0â¦20.10.0 Some files have been moved from TNT/sentry-onpremise to ANS/sentry/templates to support Ansible variables for each environment Deploy stack Previous Next © Copyright 2024, TNT. Built with Sphinx using a theme provided by Read the Docs .