Fortigate troubleshooting — SBAB Docs  documentation SBAB Docs Ansible Controller Ansible Roles Ansible Vault Argo Workflows Authentication & Authorization Bitbucket Boost Chatbot Booli Ceph Dex Fortigate troubleshooting SSL issues/ SSL inspections errors Denials in the proxy Generate certificate Go GitHub Copilot GitLab @Sbab User Guide GitLab Maintenance Grafana Istio Java Jenkins Jenkinsfile Jmeter Kafka Maintenance Kafka @Sbab User Guide Kafka Connect Kubectl Access Kubernetes Lab environment Local Open Web Metrics infrastructure MongoDB Netbox NVIDIA Neo4J Sonatype Nexus repository Oracle OWASP Database OWASP @Sbab User Guide Pact Principles of Security Prometheus ReactJS Redis Renovate S3 Security Guidelines for Developers Sentry Maintenance Sentry User Guide Configuring Variables for Services Deployed to Kubernetes Software Architecture SonarQube Maintenance SonarQube User Guide Structurizr System Landscape Vagrant Zipkin Windows Pipelines SBAB Docs » Fortigate troubleshooting View page source Fortigate troubleshooting ï Basic troubleshooting for firewall issues that can be encountered in pipelines or elsewhere which may require exclusions/ whitelisting in https://gitlab.sbab.se/security/fortigate_feeds or further help by the network team. SSL issues/ SSL inspections errors ï Searching for the message msg=âSSL Alert receivedâ in the sourcetype fortigate as such Fortigate SSL error example search This search will show errors that are caused by SSL inspection which is done by default by our fortiproxy. You can run nslookup on any IP address that you suspect has to do with troubleshooting of the specific issues you have to find out if its related. The error you will encounter in java specifically when this is the issue will be the one below: sun.security.validator.ValidatorException: PKIX path building failed: sun.security.provider.certpath.SunCertPathBuilderException: unable to find valid certification path to requested target This error is misleading as it is pointing at a specific certificate missing in the java keystore so as a precaution, make sure you have all needed certificates in the java keystore before determining that this is the cause. If you come to the conlusion that the log you find from the fortigate together with the SSL error message and with an IP address matching up to what it is you are trying to reach, the FQDN should be added to the No SSL check exclusion list https://gitlab.sbab.se/security/fortigate_feeds/-/blob/master/files/fortigate/no_ssl_check.txt Denials in the proxy ï When something cannot be reached you can check the logs in the proxy to see if the proxy is the one causing the block as such: Fortigate denial example search Important to note that if you find the IP you are trying to reach as blocked in the logs WITH the profile field being EMPTY or not existing, that request was not done through the proxy, if thats the case, your local proxy settings are not correctly set. You can add source IP to the search to narrow down to easier find the logs you are looking for. srcip = 10 .43* If you find in the logs that the proxy is blocking what you are trying to reach the FQDN of that site should be added to the whitelist https://gitlab.sbab.se/security/fortigate_feeds/-/blob/master/files/fortigate/server_nexus_permit.txt Previous Next © Copyright 2024, TNT. Built with Sphinx using a theme provided by Read the Docs .