SonarQube User Guide — SBAB Docs  documentation SBAB Docs Ansible Controller Ansible Roles Ansible Vault Argo Workflows Authentication & Authorization Bitbucket Boost Chatbot Booli Ceph Dex Fortigate troubleshooting Generate certificate Go GitHub Copilot GitLab @Sbab User Guide GitLab Maintenance Grafana Istio Java Jenkins Jenkinsfile Jmeter Kafka Maintenance Kafka @Sbab User Guide Kafka Connect Kubectl Access Kubernetes Lab environment Local Open Web Metrics infrastructure MongoDB Netbox NVIDIA Neo4J Sonatype Nexus repository Oracle OWASP Database OWASP @Sbab User Guide Pact Principles of Security Prometheus ReactJS Redis Renovate S3 Security Guidelines for Developers Sentry Maintenance Sentry User Guide Configuring Variables for Services Deployed to Kubernetes Software Architecture SonarQube Maintenance SonarQube User Guide Test Coverage and Execution Reports Java JavaScript Jest Vitest Python Good to know Changing the Quality Gate Excluding repository from Sonar scanning Structurizr System Landscape Vagrant Zipkin Windows Pipelines SBAB Docs » SonarQube User Guide View page source SonarQube User Guide ï Test Coverage and Execution Reports ï The default quality gate requires a project to have at least 50% test coverage. To meet this requirement, you must generate a test coverage report for your project. The report must be generated in the Cobertura format and be named coverage.xml .
Sonarqube can also display historic data of your projects test execution. To enable this you must generate a test execution report in a format that Sonarqube can read. detailed information about how to generate the report can be found here . Here are examples of dependencies to use for generating reports in different languages: Java ï When developing in Java locally, IntelliJ facilitates the generation of test coverage reports. The pipeline doesnât require the installation of any extra dependencies. JavaScript ï For JavaScript, there are several tools you can use for testing and generating reports. Jest ï Jest is a popular testing framework for JavaScript. Install it with your package manager of choice: npm install --save-dev jest Then add a script to your package.json : "scripts" : { "test" : "jest --coverage" } To enable test execution reports we recommend using the jest-sonar plugin. Install it with your package manager of choice and configure it in your jest.config.js : module . exports = { // ... reporters : [ "default" , "jest-sonar" ], // ... }; Vitest ï Vitest is a test runner designed for Vite. Install it with your package manager of choice: npm install --save-dev vitest Then add a script to your package.json : "scripts" : { "test" : "vitest --coverage" } To enable test execution reports we recommend using the vitest-sonar-reporter plugin. Install it with your package manager of choice and configure it in your vite.config.ts : import { defineConfig } from 'vite' ; import { sonarReporter } from 'vitest-sonar-reporter' ; export default defineConfig ({ // ... plugins : [ sonarReporter () ], // ... }); Python ï For Python, you can use pytest together with pytest-cov. Install it with pip: pip install pytest pytest-cov Then run your tests with coverage: pytest --cov = . --cov-report = xml --junitxml = sonar-report.xml Good to know ï Sonar will complain about code coverage for the lombok annotations. Add the following properties in lombok.config and
place it in the serviceâs root config.stopBubbling = true
lombok.addLombokGeneratedAnnotation = true It will add @Generated on the generated methods and sonar will ignore those for the code coverage Changing the Quality Gate ï There may be instances where you need to modify a projectâs Quality Gate. For example, if your project lacks tests and consequently doesnât meet the Test Coverage requirement of the default Quality Gate. To adjust a projectâs Quality Gate, adhere to the following instructions: Navigate to the Sonar Quality Gate Switcher repository Initiate a manual pipeline by navigating to CI/CD -> Pipelines -> Run Pipeline Input values for these variables: SONAR_PROJECT_NAME - The name of the project you wish to switch Quality Gate for SONAR_QUALITY_GATE - The title of the Quality Gate you wish to switch to Press âRun Pipelineâ and await the pipelineâs completion Excluding repository from Sonar scanning ï If you wish to prevent a failed Sonar scan from affecting a projectâs pipelines, you can exclude specific repositories. Simply add the complete repository link to the list of excluded subjects found here . This ensures that the scanning process does not interfere with the projectâs pipeline workflows. This action must also be approved by either the Head of Security, Head of TNT or the Head of Development. Previous Next © Copyright 2024, TNT. Built with Sphinx using a theme provided by Read the Docs .