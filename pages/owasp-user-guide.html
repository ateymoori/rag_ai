OWASP @Sbab User Guide — SBAB Docs  documentation SBAB Docs Ansible Controller Ansible Roles Ansible Vault Argo Workflows Authentication & Authorization Bitbucket Boost Chatbot Booli Ceph Dex Fortigate troubleshooting Generate certificate Go GitHub Copilot GitLab @Sbab User Guide GitLab Maintenance Grafana Istio Java Jenkins Jenkinsfile Jmeter Kafka Maintenance Kafka @Sbab User Guide Kafka Connect Kubectl Access Kubernetes Lab environment Local Open Web Metrics infrastructure MongoDB Netbox NVIDIA Neo4J Sonatype Nexus repository Oracle OWASP Database OWASP @Sbab User Guide Using OWASP dependency-check-maven locally Tools used to analyze the dependencies How to fix security issues in your maven build How to add a repo for automatic OWASP scanning Suppressing CVE entries Pact Principles of Security Prometheus ReactJS Redis Renovate S3 Security Guidelines for Developers Sentry Maintenance Sentry User Guide Configuring Variables for Services Deployed to Kubernetes Software Architecture SonarQube Maintenance SonarQube User Guide Structurizr System Landscape Vagrant Zipkin Windows Pipelines SBAB Docs » OWASP @Sbab User Guide View page source OWASP @Sbab User Guide ï Using OWASP dependency-check-maven locally ï Below you can find steps to run Maven OWASP dependency check plugin locally. Add proxy configuration to your local maven settings file: <proxies> <proxy> <id> trend3_http </id> <active> true </active> <protocol> http </protocol> <host> trend3.sbab.ad </host> <port> 8080 </port> <nonProxyHosts> localhost|127.0.0.1|*.sbab.ad|*.sbab.se|nexus.common.sbab.se </nonProxyHosts> </proxy> </proxies> Run mvn org.owasp:dependency-check-maven:8.1.2:check -DmavenSettingsProxyId = trend3_http \ -Dformat = xml -DassemblyAnalyzerEnabled = false \ -DsuppressionFile = https://stash.sbab.se/projects/TNT/repos/jenkins-pipeline/raw/resources/suppression/suppression.xml Tools used to analyze the dependencies ï There are mainly two tools that can be used to analyze the local project: Effective pom: mvn help:effective-pom or Intellij IDEA Maven -> Show Effective POM Running this command from the pom.xml directory will show the full effective pom that the project is using, including
any property, dependency, plugin etc added by either a parent pom or an import. It will help you to find properies used
for version numbers of included artifacts. <properties> ... <snakeyaml.version> 1.33 </snakeyaml.version> ... </properties> Dependency tree: mvn dependency:tree or Intellij IDEA Maven -> Show Dependencies... Running this command will provide information of how and where a vulnerable artifact is added to your project. How to fix security issues in your maven build ï There are several ways to fix security issues related to artifacts used in the maven build, each with different pros and
cons. In this guide, we will list the different ways in descending order of suitability: 1. If the Maven build contains a reference to a parent pom file with upgraded dependency version, such as
spring-boot-starter-parent, upgrade this version if it fixes the issue. 2. If the Maven build contains a reference to a parent pom file where the version number of the vulnerable artifact is
specified, then update this value as an overridden property in the pom file. For example: <properties> <!-- snakeyaml 1.30 has several CVE problems --> <snakeyaml.version> 1.33 </snakeyaml.version> <!-- CVE-2020-5408, CVE-2022-31690, CVE-2022-31692 --> <spring-security.version> 5.7.5 </spring-security.version> </properties> If the vulnerable artifact is used as a transitive dependency, it can be updated in a dependencyManagement block: <dependencyManagement> <dependencies> <dependency> <groupId> org.yaml </groupId> <artifactId> snakeyaml </artifactId> <version> 1.33 </version> </dependency> </dependencies> </dependencyManagement> Adding an artifact with a specific version to the dependencyManagement section will result in this version being used
for the artifact, if added as a transitive dependency or specified in the local pom file without a specific version
number. Note that if the transitive dependency for the vulnerable artifact is removed in a future version, it will no
longer be included in the project if dependencyManagement is used instead of a direct dependency. It also signals that
you are not directly dependent of this library from the code that you are writing and maintaining. Note Artifacts added as transitive dependencies from an artifact updated using dependencyManagement will not be updated!
For example: <dependencyManagement> <dependencies> <dependency> <groupId> org.springframework.security </groupId> <artifactId> spring-security-core </artifactId> <version> 5.7.5 </version> </dependency> </dependencies> </dependencyManagement> mvn dependency : tree ... [ INFO ] +- se . sbab . common : jwt - auth - spring : jar : 1.0.68 : compile [ INFO ] | +- com . fasterxml . jackson . core : jackson - databind : jar : 2.13.4.2 : compile [ INFO ] | +- org . springframework . security : spring - security - core : jar : 5.7.5 : compile [ INFO ] | | \ - org . springframework . security : spring - security - crypto : jar : 5.7.4 : compile ... Note that the transitive dependency spring-security-crypto from the updated spring-security-core does NOT use version 5.7.5 in this case. 4. If the vulnerable artifact is used as a transitive dependency, it can be updated using an exclusion block and the
updated version can be added as a direct dependency: <dependency> <groupId> se.sbab.common </groupId> <artifactId> jwt-auth-spring </artifactId> <version> 1.0.68 </version> <exclusions> <exclusion> <groupId> org.springframework.security </groupId> <artifactId> spring-security-core </artifactId> </exclusion> </exclusions> </dependency> <!-- CVE-2020-5408, CVE-2022-31690, CVE-2022-31692 --> <dependency> <groupId> org.springframework.security </groupId> <artifactId> spring-security-core </artifactId> <version> 5.7.5 </version> </dependency> mvn dependency : tree ... [ INFO ] +- se . sbab . common : jwt - auth - spring : jar : 1.0.68 : compile [ INFO ] | +- com . fasterxml . jackson . core : jackson - databind : jar : 2.13.4.2 : compile [ INFO ] | +- org . bitbucket . b_c : jose4j : jar : 0.7.6 : compile [ INFO ] | +- org . apache . commons : commons - lang3 : jar : 3.12.0 : compile [ INFO ] | +- org . springframework . boot : spring - boot : jar : 2.7.5 : compile [ INFO ] | \ - org . apache . httpcomponents : httpclient : jar : 4.5.13 : compile [ INFO ] | +- org . apache . httpcomponents : httpcore : jar : 4.4.15 : compile [ INFO ] | \ - commons - codec : commons - codec : jar : 1.15 : compile [ INFO ] +- org . springframework . security : spring - security - core : jar : 5.7.5 : compile [ INFO ] | +- org . springframework . security : spring - security - crypto : jar : 5.7.4 : compile ... Note that the transitive dependency spring-security-crypto from the updated spring-security-core is included
by spring in the dependencyManagement section using version 5.7.4. This is why the transitive dependency is NOT updated in this case and also a reason why this approach is not preferred. 5. If the vulnerable artifact is used as a transitive dependency, it can be updated by adding a newer version
with higher priority than the affected artifact. Dependency mediation - this determines what version of an artifact will be chosen when multiple versions are
encountered as dependencies. Maven picks the ânearest definitionâ. That is, it uses the version of the closest
dependency to your project in the tree of dependencies. You can always guarantee a version by declaring it explicitly
in your projectâs POM. Note that if two dependency versions are at the same depth in the dependency tree, the first
declaration wins. Adding the artifact at the root level at the top of the dependencies section will therefore override the version number: <dependencies> <!-- CVE-2020-5408, CVE-2022-31690, CVE-2022-31692 --> <dependency> <groupId> org.springframework.security </groupId> <artifactId> spring-security-core </artifactId> <version> 5.7.5 </version> </dependency> ... </dependencies> mvn dependency : tree ... [ INFO ] +- org . springframework . security : spring - security - core : jar : 5.7.5 : compile [ INFO ] | +- org . springframework . security : spring - security - crypto : jar : 5.7.4 : compile [ INFO ] | +- org . springframework : spring - aop : jar : 5.3.23 : compile [ INFO ] | +- org . springframework : spring - beans : jar : 5.3.23 : compile [ INFO ] | +- org . springframework : spring - context : jar : 5.3.23 : compile [ INFO ] | +- org . springframework : spring - core : jar : 5.3.23 : compile [ INFO ] | | \ - org . springframework : spring - jcl : jar : 5.3.23 : compile [ INFO ] | \ - org . springframework : spring - expression : jar : 5.3.23 : compile ... How to add a repo for automatic OWASP scanning ï Check out the dev-branch of the automatic-owasp-scan repo Note Do not create a feature branch Add the repo/repos you wish to have scanned here Specify the bitbucket project key Specify which slack channel that should receive a message if your code doesnât live up to the OWASP requirements Specify the repo/repos to be scanned Commit and push Suppressing CVE entries ï If Dependency check returns a confirmed false positive, the CVE-reference can be added to a list of suppressions. This action must be approved by either the Head of Security, Head of TNT or the Head of Development. Note the CVE-reference for the vulnerability, i.e CVE-2023-12345 Make a pull request with the added CVE-reference to the list found here . Provide a detailed reason both in the note field as well as in the commit message. Example entry: <suppress> <notes> Reason for suppressing the CVE </notes> <cve> CVE-2023-12345 </cve> </suppress> Previous Next © Copyright 2024, TNT. Built with Sphinx using a theme provided by Read the Docs .